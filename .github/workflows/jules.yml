name: Jules

on:
  issues:
    types: [labeled]

jobs:
  jules:
    if: github.event.label.name == 'jules'
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - name: Invoke Jules
        if: ${{ contains(fromJSON('["srMarlins"]'), github.event.issue.user.login) }}
        uses: google-labs-code/jules-action@v1.0.0
        with:
          prompt: |
            Fix the following GitHub issue for the ChromaDMX project.

            Issue #${{ github.event.issue.number }}: ${{ github.event.issue.title }}

            ${{ github.event.issue.body }}

            Instructions:
            - This is a Kotlin Multiplatform project (Android + iOS)
            - Shared code lives in shared/, platform code in android/ and ios/
            - Use Compose Multiplatform for UI (shared UI elements)
            - Follow existing code conventions and patterns
            - Run tests with ./gradlew testAndroidHostTest for relevant modules
            - Create a PR with your changes when done
          jules_api_key: ${{ secrets.JULES_API_KEY }}
